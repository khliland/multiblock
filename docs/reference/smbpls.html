<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Sparse Multiblock Partial Least Squares - sMB-PLS — smbpls • multiblock</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sparse Multiblock Partial Least Squares - sMB-PLS — smbpls"><meta name="description" content="sMB-PLS is an adaptation of MB-PLS (mbpls) that enforces sparseness in loading weights
when computing PLS components in the global model."><meta property="og:description" content="sMB-PLS is an adaptation of MB-PLS (mbpls) that enforces sparseness in loading weights
when computing PLS components in the global model."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multiblock</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.8.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/vignette_A_data.html">A. Data handling</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_B_basic.html">B. Basic analysis</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_C_unsupervised.html">C. Unsupervised multiblock analysis</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_D_asca.html">D. ASCA</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_E_supervised.html">E. Supervised multiblock analysis</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_F_complex.html">F. Complex multiblock analysis</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/khliland/multiblock/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sparse Multiblock Partial Least Squares - sMB-PLS</h1>
      <small class="dont-index">Source: <a href="https://github.com/khliland/multiblock/blob/HEAD/R/supervised.R" class="external-link"><code>R/supervised.R</code></a></small>
      <div class="d-none name"><code>smbpls.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>sMB-PLS is an adaptation of MB-PLS (<code><a href="mbpls.html">mbpls</a></code>) that enforces sparseness in loading weights
when computing PLS components in the global model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">smbpls</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">subset</span>,</span>
<span>  <span class="va">na.action</span>,</span>
<span>  X <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ncomp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  shrink <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  truncation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  trunc.width <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  blockScale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sqrtnvar"</span>, <span class="st">"ssq"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>Model formula accepting a single response (block) and predictor block names separated by + signs.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The data set to analyse.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>Expression for subsetting the data before modelling.</p></dd>


<dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>How to handle NAs (no action implemented).</p></dd>


<dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code>list</code> of input blocks. If X is supplied, the formula interface is skipped.</p></dd>


<dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p><code>matrix</code> of responses.</p></dd>


<dt id="arg-ncomp">ncomp<a class="anchor" aria-label="anchor" href="#arg-ncomp"></a></dt>
<dd><p><code>integer</code> number of PLS components.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p><code>logical</code> for autoscaling inputs (default = FALSE).</p></dd>


<dt id="arg-shrink">shrink<a class="anchor" aria-label="anchor" href="#arg-shrink"></a></dt>
<dd><p><code>numeric</code> scalar indicating degree of L1-shrinkage/Soft-Thresholding (optional), 0 &lt;= shrink &lt; 1.</p></dd>


<dt id="arg-truncation">truncation<a class="anchor" aria-label="anchor" href="#arg-truncation"></a></dt>
<dd><p><code>character</code> indicating type of truncation (optional) "Lenth" uses
asymmetric confidence intervals to determine outlying loading weights. "quantile" uses
a quantile plot approach to determining outliers.</p></dd>


<dt id="arg-trunc-width">trunc.width<a class="anchor" aria-label="anchor" href="#arg-trunc-width"></a></dt>
<dd><p><code>numeric</code> indicating confidence of "Lenth type" confidence interval
or quantile in "quantile plot" approach. Default = 0.95.</p></dd>


<dt id="arg-blockscale">blockScale<a class="anchor" aria-label="anchor" href="#arg-blockscale"></a></dt>
<dd><p>Either a <code>character</code> indicating type of block scaling or a <code>numeric</code> vector of block weights (see Details).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments to pls::plsr.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>multiblock, mvr</code> object with super-scores, super-loadings, block-scores and block-loading, and the underlying
<code>mvr</code> (PLS) object for the super model, with all its result and plot possibilities. Relevant plotting functions: <code><a href="multiblock_plots.html">multiblock_plots</a></code>
and result functions: <code><a href="multiblock_results.html">multiblock_results</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Two versions of sparseness are supplied: Soft-Threshold PLS, also
known as Sparse PLS, and Truncation PLS. The former uses L1 shrinkage of loading weights, while the latter
comes in two flavours, both estimating inliers and outliers. The "Lenth" method uses asymmetric confidence
intervals around the median of a loading weigh vector to estimate inliers. The "quantile" method uses
a quantile plot approach to estimate outliers as deviations from the estimated quantile line. As with
ordinary MB-PLS scaled input blocks (1/sqrt(ncol)) are used.</p>
<p>Block weighting is performed after scaling all variables and is by default
<code>"sqrtnvar"</code>: 1/sqrt(ncol(X[[i]])) in each block. Alternatives
are <code>"ssq"</code>: 1/norm(X[[i]], "F")^2 and <code>"none"</code>: 1/1. Finally, if
a <code>numeric</code> vector is supplied, it will be used to scale the blocks
after <code>"ssq"</code> scaling, i.e., Z[[i]] = X[[i]] / norm(X[[i]], "F")^2 * blockScale[i].</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Sæbø, S.; Almøy, T.; Aarøe, J. &amp; Aastveit, A. ST-PLS: a multi-directional nearest shrunken centroid type classifier via PLS Journal of Chemometrics: A Journal of the Chemometrics Society, Wiley Online Library, 2008, 22, 54-62.</p></li>
<li><p>Lê Cao, K.; Rossouw, D.; Robert-Granié, C. &amp; Besse, P. A sparse PLS for variable selection when integrating omics data Statistical applications in genetics and molecular biology, 2008, 7.</p></li>
<li><p>Liland, K.; Høy, M.; Martens, H. &amp; Sæbø, S. Distribution based truncation for variable selection in subspace methods for multivariate regression Chemometrics and Intelligent Laboratory Systems, 2013, 122, 103-111.</p></li>
<li><p>Karaman, I.; Nørskov, N.; Yde, C.; Hedemann, M.; Knudsen, K. &amp; Kohler, A. Sparse multi-block PLSR for biomarker discovery when integrating data from LC–MS and NMR metabolomics Metabolomics, 2015, 11, 367-379.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Overviews of available methods, <code><a href="multiblock.html">multiblock</a></code>, and methods organised by main structure: <code><a href="basic.html">basic</a></code>, <code><a href="unsupervised.html">unsupervised</a></code>, <code><a href="asca.html">asca</a></code>, <code><a href="supervised.html">supervised</a></code> and <code><a href="complex.html">complex</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">potato</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Truncation MB-PLS </span></span></span>
<span class="r-in"><span><span class="co"># Loading weights inside 60% confidence intervals around the median are set to 0.</span></span></span>
<span class="r-in"><span><span class="va">tmb</span> <span class="op">&lt;-</span> <span class="fu">smbpls</span><span class="op">(</span><span class="va">Sensory</span> <span class="op">~</span> <span class="va">Chemical</span><span class="op">+</span><span class="va">Compression</span>, data<span class="op">=</span><span class="va">potato</span>, ncomp <span class="op">=</span> <span class="fl">5</span>, </span></span>
<span class="r-in"><span>              truncation <span class="op">=</span> <span class="st">"Lenth"</span>, trunc.width <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span>              </span></span>
<span class="r-in"><span><span class="co"># Alternative XY-interface</span></span></span>
<span class="r-in"><span><span class="va">tmb.XY</span> <span class="op">&lt;-</span> <span class="fu">smbpls</span><span class="op">(</span>X<span class="op">=</span><span class="va">potato</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Chemical'</span>,<span class="st">'Compression'</span><span class="op">)</span><span class="op">]</span>, Y<span class="op">=</span><span class="va">potato</span><span class="op">[[</span><span class="st">'Sensory'</span><span class="op">]</span><span class="op">]</span>, ncomp <span class="op">=</span> <span class="fl">5</span>, </span></span>
<span class="r-in"><span>              truncation <span class="op">=</span> <span class="st">"Lenth"</span>, trunc.width <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">tmb</span>, <span class="va">tmb.XY</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/pls/man/scoreplot.html" class="external-link">scoreplot</a></span><span class="op">(</span><span class="va">tmb</span>, labels<span class="op">=</span><span class="st">"names"</span><span class="op">)</span> <span class="co"># Exploiting mvr object structure from pls package</span></span></span>
<span class="r-plt img"><img src="smbpls-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="multiblock_plots.html">loadingweightplot</a></span><span class="op">(</span><span class="va">tmb</span>, labels<span class="op">=</span><span class="st">"names"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="smbpls-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Soft-Threshold / Sparse MB-PLS </span></span></span>
<span class="r-in"><span><span class="co"># Loading weights are subtracted by 60% of maximum value.</span></span></span>
<span class="r-in"><span><span class="va">smb</span> <span class="op">&lt;-</span> <span class="fu">smbpls</span><span class="op">(</span>X<span class="op">=</span><span class="va">potato</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Chemical'</span>,<span class="st">'Compression'</span><span class="op">)</span><span class="op">]</span>, Y<span class="op">=</span><span class="va">potato</span><span class="op">[[</span><span class="st">'Sensory'</span><span class="op">]</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>              ncomp <span class="op">=</span> <span class="fl">5</span>, shrink <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">smb</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sparse Multiblock PLS (Soft-Threshold) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> smbpls(X = potato[c("Chemical", "Compression")], Y = potato[["Sensory"]],     ncomp = 5, shrink = 0.6)</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/pls/man/scoreplot.html" class="external-link">scoreplot</a></span><span class="op">(</span><span class="va">smb</span>, labels<span class="op">=</span><span class="st">"names"</span><span class="op">)</span> <span class="co"># Exploiting mvr object structure from pls package</span></span></span>
<span class="r-plt img"><img src="smbpls-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="multiblock_plots.html">loadingweightplot</a></span><span class="op">(</span><span class="va">smb</span>, labels<span class="op">=</span><span class="st">"names"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="smbpls-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Emphasis may be different for blocks</span></span></span>
<span class="r-in"><span><span class="va">smb</span> <span class="op">&lt;-</span> <span class="fu">smbpls</span><span class="op">(</span>X<span class="op">=</span><span class="va">potato</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Chemical'</span>,<span class="st">'Compression'</span><span class="op">)</span><span class="op">]</span>, Y<span class="op">=</span><span class="va">potato</span><span class="op">[[</span><span class="st">'Sensory'</span><span class="op">]</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>              ncomp <span class="op">=</span> <span class="fl">5</span>, shrink <span class="op">=</span> <span class="fl">0.6</span>, blockScale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristian Hovde Liland.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

