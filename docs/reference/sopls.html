<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Sequential and Orthogonalized PLS (SO-PLS) — sopls • multiblock</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Sequential and Orthogonalized PLS (SO-PLS) — sopls" />
<meta property="og:description" content="Function for computing standard SO-PLS based on the interface of the pls package.

" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multiblock</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vignette_A_data.html">A. Data handling</a>
    </li>
    <li>
      <a href="../articles/vignette_B_basic.html">B. Basic analysis</a>
    </li>
    <li>
      <a href="../articles/vignette_C_unsupervised.html">C. Unsupervised multiblock analysis</a>
    </li>
    <li>
      <a href="../articles/vignette_D_asca.html">D. ASCA</a>
    </li>
    <li>
      <a href="../articles/vignette_E_supervised.html">E. Supervised multiblock analysis</a>
    </li>
    <li>
      <a href="../articles/vignette_F_complex.html">F. Complex multiblock analysis</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/khliland/multiblock/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sequential and Orthogonalized PLS (SO-PLS)</h1>
    <small class="dont-index">Source: <a href='https://github.com/khliland/multiblock/blob/master/R/sopls.R'><code>R/sopls.R</code></a></small>
    <div class="hidden name"><code>sopls.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function for computing standard SO-PLS based on the interface of the <code>pls</code> package.</p>


    </div>

    <pre class="usage"><span class='fu'>sopls</span><span class='op'>(</span>
  <span class='va'>formula</span>,
  <span class='va'>ncomp</span>,
  max_comps <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>ncomp</span><span class='op'>)</span>, <span class='fl'>20</span><span class='op'>)</span>,
  <span class='va'>data</span>,
  <span class='va'>subset</span>,
  <span class='va'>na.action</span>,
  scale <span class='op'>=</span> <span class='cn'>FALSE</span>,
  validation <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"none"</span>, <span class='st'>"CV"</span>, <span class='st'>"LOO"</span><span class='op'>)</span>,
  sequential <span class='op'>=</span> <span class='cn'>FALSE</span>,
  segments <span class='op'>=</span> <span class='fl'>10</span>,
  sel.comp <span class='op'>=</span> <span class='st'>"opt"</span>,
  progress <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>Model formula accepting a single response (block) and predictor block names separated by + signs.</p></td>
    </tr>
    <tr>
      <th>ncomp</th>
      <td><p>Numeric vector of components per block or scalar of overall maximum components.</p></td>
    </tr>
    <tr>
      <th>max_comps</th>
      <td><p>Maximum total number of components from all blocks combined (&lt;= sum(ncomp)).</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>The data set to analyse.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>Expression for subsetting the data before modelling.</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>How to handle NAs (no action implemented).</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>Logical indicating if variables should be scaled.</p></td>
    </tr>
    <tr>
      <th>validation</th>
      <td><p>Optional cross-validation strategy "CV" or "LOO".</p></td>
    </tr>
    <tr>
      <th>sequential</th>
      <td><p>Logical indicating if optimal components are chosen sequentially or globally.</p></td>
    </tr>
    <tr>
      <th>segments</th>
      <td><p>Optional number of segments or list of segments for cross-validation. (See <code>[pls::cvsegments()]</code>).</p></td>
    </tr>
    <tr>
      <th>sel.comp</th>
      <td><p>Character indicating if sequential optimal number of components should be chosen as minimum RMSECV ('opt', default) or by Chi-square test ('chi').</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>Logical indicating if a progress bar should be displayed while cross-validating.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to underlying methods.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An <code>sopls, mvr</code> object with scores, loadings, etc.
associated with printing and plotting methods.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>SO-PLS is a method which handles two or more input blocks by sequentially performing
PLS on blocks against a response and orthogonalising the remaining blocks on the extracted components.
Component number optimisation can either be done globally (best combination across blocks) or sequentially
(determine for one block, move to next, etc.).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Jørgensen K, Mevik BH, Næs T. Combining designed experiments with several blocks of spectroscopic data. Chemometr Intell Lab Syst. 2007;88(2): 154–166.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>SO-PLS result functions, <code><a href='sopls_results.html'>sopls_results</a></code>, SO-PLS plotting functions, <code><a href='sopls_plots.html'>sopls_plots</a></code>, SO-PLS Måge plot, <code><a href='maage.html'>maage</a></code>, and SO-PLS path-modelling, <code><a href='SO_TDI.html'>SO_TDI</a></code>.
Overviews of available methods, <code><a href='multiblock.html'>multiblock</a></code>, and methods organised by main structure: <code><a href='basic.html'>basic</a></code>, <code><a href='unsupervised.html'>unsupervised</a></code>, <code><a href='asca.html'>asca</a></code>, <code><a href='supervised.html'>supervised</a></code> and <code><a href='complex.html'>complex</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>potato</span><span class='op'>)</span>
<span class='va'>so</span> <span class='op'>&lt;-</span> <span class='fu'>sopls</span><span class='op'>(</span><span class='va'>Sensory</span> <span class='op'>~</span> <span class='va'>Chemical</span> <span class='op'>+</span> <span class='va'>Compression</span>, data<span class='op'>=</span><span class='va'>potato</span>, ncomp<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>10</span><span class='op'>)</span>, 
            max_comps<span class='op'>=</span><span class='fl'>10</span>, validation<span class='op'>=</span><span class='st'>"CV"</span>, segments<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>so</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Data: 	X dimension: 26 0 
#&gt; 	Y dimension: 26 9
#&gt; Fit method: PKPLS
#&gt; Number of components considered: 10
#&gt; 
#&gt; VALIDATION: RMSEP
#&gt; Cross-validated using 10 random segments.
#&gt;    0,0     0,1     0,2     0,3     0,4     0,5     0,6     0,7     0,8     0,9  
#&gt; 1.1472  0.9974  1.1034  0.9942  1.0159  1.1523  1.0857  1.1834  1.2494  1.3022  
#&gt;   0,10     1,0     1,1     1,2     1,3     1,4     1,5     1,6     1,7     1,8  
#&gt; 1.2690  0.9058  0.8860  0.9779  0.9029  0.8942  0.9320  0.9441  1.0542  1.1243  
#&gt;    1,9     2,0     2,1     2,2     2,3     2,4     2,5     2,6     2,7     2,8  
#&gt; 1.1369  0.8077  0.7023  0.7124  0.7737  0.8072  0.8651  0.8511  0.9742  1.0048  
#&gt;    3,0     3,1     3,2     3,3     3,4     3,5     3,6     3,7     4,0     4,1  
#&gt; 0.7439  0.7275  0.7111  0.7716  0.8322  0.8846  0.8893  0.9793  0.7494  0.7165  
#&gt;    4,2     4,3     4,4     4,5     4,6     5,0     5,1     5,2     5,3     5,4  
#&gt; 0.7272  0.7748  0.8135  0.9157  0.9001  0.7752  0.7491  0.7593  0.8494  0.9693  
#&gt;    5,5     6,0     6,1     6,2     6,3     6,4     7,0     7,1     7,2     7,3  
#&gt; 1.0306  0.8504  0.8438  0.8198  0.9304  1.0222  0.8997  0.8910  0.8418  0.9632  
#&gt;    8,0     8,1     8,2     9,0     9,1    10,0  
#&gt; 1.0062  1.0033  0.9511  1.0682  1.0557  1.6371  
#&gt; 
#&gt; TRAINING: % variance explained
#&gt;         0,0    0,1    0,2    0,3    0,4    0,5    0,6    0,7    0,8    0,9
#&gt; X         0  45.87  55.51  62.90  66.46  67.73  74.95  78.26  79.85  82.39
#&gt; ref       0  42.19  54.73  65.01  66.85  73.96  74.10  74.44  77.45  77.57
#&gt; hard      0  39.11  41.97  42.23  43.80  50.95  54.87  56.78  59.50  74.53
#&gt; firm      0  42.55  57.44  59.44  61.06  66.78  68.62  69.02  71.34  76.53
#&gt; elas      0  38.64  65.31  73.51  75.63  77.23  79.25  81.19  83.71  86.57
#&gt; adhes     0  16.13  18.11  26.71  26.74  29.70  42.07  44.57  46.47  46.54
#&gt; grainy    0  23.21  43.78  62.23  64.02  67.18  67.72  69.83  74.79  74.79
#&gt; mealy     0  35.35  41.99  57.36  58.84  67.17  70.33  73.21  77.77  78.88
#&gt; moist     0  24.48  27.71  43.10  44.27  48.41  53.39  62.37  67.60  74.79
#&gt; chewi     0  21.98  22.78  48.17  55.50  59.96  68.39  72.54  76.39  77.42
#&gt;          0,10    1,0    1,1    1,2    1,3    1,4    1,5    1,6    1,7    1,8
#&gt; X       83.18  34.20  64.12  71.71  76.24  78.20  79.49  83.37  84.42  85.59
#&gt; ref     77.57  55.79  64.00  64.25  73.75  77.39  79.53  80.42  80.50  80.96
#&gt; hard    75.43  24.10  41.42  44.05  44.07  44.09  47.61  53.70  53.86  62.46
#&gt; firm    79.31  42.73  54.16  58.42  62.05  63.55  64.91  70.85  70.91  70.93
#&gt; elas    88.14  53.24  59.32  63.95  71.43  74.51  75.33  77.16  78.86  78.88
#&gt; adhes   54.68  17.49  22.70  33.54  33.75  34.70  34.90  39.43  48.51  48.92
#&gt; grainy  74.82  57.69  58.26  58.39  71.89  75.95  76.07  76.72  77.73  79.00
#&gt; mealy   79.25  61.37  65.64  66.70  74.33  75.36  77.44  78.35  79.55  80.15
#&gt; moist   77.22  57.32  58.51  62.12  66.20  66.35  67.13  67.14  69.51  71.02
#&gt; chewi   81.68  53.27  54.25  64.22  66.35  69.59  69.96  72.80  77.64  77.64
#&gt;           1,9    2,0    2,1    2,2    2,3    2,4    2,5    2,6    2,7    2,8
#&gt; X       86.07  42.76  72.61  79.40  81.41  82.69  84.98  88.16  88.87  89.84
#&gt; ref     81.20  76.03  85.17  87.21  89.03  90.67  90.68  91.36  91.36  91.39
#&gt; hard    69.98  25.29  44.10  46.63  46.63  46.88  52.03  61.89  64.48  73.84
#&gt; firm    80.21  55.93  69.19  76.45  76.45  76.80  77.79  82.58  82.64  86.03
#&gt; elas    87.63  63.10  70.21  78.03  78.08  78.17  80.37  82.19  84.54  85.69
#&gt; adhes   49.97  34.43  39.48  46.70  46.78  48.48  54.50  56.16  67.45  72.74
#&gt; grainy  79.50  83.95  84.78  87.19  88.01  88.56  89.28  89.29  89.30  89.49
#&gt; mealy   80.19  81.14  85.67  85.68  87.94  88.28  88.57  89.15  89.69  90.49
#&gt; moist   72.44  67.94  69.06  70.49  72.51  72.53  72.61  72.80  73.61  78.69
#&gt; chewi   78.05  70.55  71.41  77.11  77.11  78.09  78.17  79.79  83.27  86.51
#&gt;           3,0    3,1    3,2    3,3    3,4    3,5    3,6    3,7    4,0    4,1
#&gt; X       63.76  78.59  84.55  86.77  87.73  90.09  91.81  92.46  70.09  80.35
#&gt; ref     84.50  86.31  87.91  89.34  91.72  91.74  93.12  93.13  84.91  87.28
#&gt; hard    29.51  45.43  50.00  50.23  51.56  54.69  61.12  63.12  30.80  49.39
#&gt; firm    62.42  68.64  76.93  76.96  77.84  78.25  82.67  82.72  62.64  73.46
#&gt; elas    69.44  70.75  78.04  78.06  78.07  80.60  82.75  85.36  69.94  73.16
#&gt; adhes   34.51  46.88  50.83  51.04  51.60  57.45  58.26  69.10  64.76  65.66
#&gt; grainy  87.18  87.45  88.87  89.86  90.34  91.06  91.37  91.45  87.20  87.21
#&gt; mealy   84.89  86.14  86.18  88.32  89.25  89.48  91.02  91.95  88.83  88.96
#&gt; moist   70.03  70.05  72.13  74.57  74.71  74.88  74.97  76.40  75.09  76.33
#&gt; chewi   70.56  72.61  77.34  77.39  78.58  78.58  79.89  83.77  82.06  82.29
#&gt;           4,2    4,3    4,4    4,5    4,6    5,0    5,1    5,2    5,3    5,4
#&gt; X       87.12  88.89  89.78  92.03  93.37  75.21  84.27  91.16  92.52  93.47
#&gt; ref     88.13  89.65  92.48  92.54  93.63  85.03  88.23  89.16  90.27  92.85
#&gt; hard    49.95  50.65  50.76  54.96  60.99  41.38  53.88  54.08  54.33  54.70
#&gt; firm    77.00  77.10  77.44  78.23  83.34  68.24  75.97  78.78  78.78  79.40
#&gt; elas    78.98  79.09  79.43  82.78  83.85  72.35  74.56  79.87  80.48  80.91
#&gt; adhes   67.28  68.26  69.21  70.41  70.90  64.77  65.81  67.35  67.83  69.01
#&gt; grainy  89.07  90.46  91.63  92.15  92.30  87.53  87.56  89.67  90.98  91.93
#&gt; mealy   88.99  93.13  94.52  94.64  95.00  89.21  89.65  89.73  93.45  94.51
#&gt; moist   76.60  82.33  82.90  82.90  83.28  79.72  79.91  79.98  83.86  84.08
#&gt; chewi   84.08  84.45  86.24  86.38  86.39  82.11  82.31  83.97  84.76  86.45
#&gt;           5,5    6,0    6,1    6,2    6,3    6,4    7,0    7,1    7,2    7,3
#&gt; X       95.40  77.28  86.22  93.18  94.55  95.63  79.57  88.43  95.46  96.65
#&gt; ref     92.91  86.80  90.43  91.47  92.26  94.07  88.07  91.60  92.62  92.70
#&gt; hard    60.53  45.27  56.94  57.05  57.64  59.71  45.28  56.91  56.99  57.22
#&gt; firm    80.75  68.98  76.56  79.17  79.42  80.55  69.02  76.72  79.16  79.35
#&gt; elas    83.34  72.55  74.96  80.08  80.15  80.26  73.76  76.39  81.36  81.61
#&gt; adhes   70.53  64.77  65.79  67.29  69.17  69.37  65.04  65.96  67.53  68.89
#&gt; grainy  92.38  91.29  91.41  93.80  94.06  94.27  91.78  91.89  94.29  94.34
#&gt; mealy   94.83  90.67  91.24  91.36  94.83  95.44  92.38  92.87  92.98  94.77
#&gt; moist   84.08  82.80  82.90  82.93  85.65  85.67  85.12  85.26  85.29  86.55
#&gt; chewi   86.50  84.60  84.72  86.16  86.49  87.50  86.05  86.22  87.61  87.62
#&gt;           8,0    8,1    8,2    9,0    9,1   10,0
#&gt; X       82.82  88.16  95.96  85.49  90.21  87.08
#&gt; ref     90.82  94.67  94.93  91.52  94.42  91.79
#&gt; hard    52.73  59.90  60.33  52.75  63.37  52.92
#&gt; firm    71.26  80.42  80.49  71.81  80.88  71.82
#&gt; elas    73.78  80.71  81.41  75.22  80.15  76.14
#&gt; adhes   68.88  68.89  69.28  71.74  72.73  74.17
#&gt; grainy  91.80  93.21  94.39  91.99  92.91  92.43
#&gt; mealy   93.59  94.05  94.31  93.75  93.98  93.83
#&gt; moist   86.40  86.60  87.34  87.11  88.40  87.14
#&gt; chewi   87.11  88.40  88.43  87.27  89.53  87.28</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kristian Hovde Liland.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


