<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>E. Supervised multiblock analysis • multiblock</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="E. Supervised multiblock analysis">
<meta property="og:description" content="multiblock">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multiblock</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette_A_data.html">A. Data handling</a>
    </li>
    <li>
      <a href="../articles/vignette_B_basic.html">B. Basic analysis</a>
    </li>
    <li>
      <a href="../articles/vignette_C_unsupervised.html">C. Unsupervised multiblock analysis</a>
    </li>
    <li>
      <a href="../articles/vignette_D_asca.html">D. ASCA</a>
    </li>
    <li>
      <a href="../articles/vignette_E_supervised.html">E. Supervised multiblock analysis</a>
    </li>
    <li>
      <a href="../articles/vignette_F_complex.html">F. Complex multiblock analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/khliland/multiblock/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vignette_E_supervised_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>E. Supervised multiblock analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/khliland/multiblock/blob/master/vignettes/vignette_E_supervised.Rmd"><code>vignettes/vignette_E_supervised.Rmd</code></a></small>
      <div class="hidden name"><code>vignette_E_supervised.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://khliland.github.io/multiblock">multiblock</a></span><span class="op">)</span>
<span class="co">#&gt; Registered S3 methods overwritten by 'lme4':</span>
<span class="co">#&gt;   method                          from</span>
<span class="co">#&gt;   cooks.distance.influence.merMod car </span>
<span class="co">#&gt;   influence.merMod                car </span>
<span class="co">#&gt;   dfbeta.influence.merMod         car </span>
<span class="co">#&gt;   dfbetas.influence.merMod        car</span>
<span class="co">#&gt; Registered S3 methods overwritten by 'multiblock':</span>
<span class="co">#&gt;   method             from</span>
<span class="co">#&gt;   print.multiblock   ade4</span>
<span class="co">#&gt;   summary.multiblock ade4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'multiblock'</span>
<span class="co">#&gt; The following object is masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     loadings</span></code></pre></div>
<div id="supervised-methods" class="section level1">
<h1 class="hasAnchor">
<a href="#supervised-methods" class="anchor"></a>Supervised methods</h1>
<p>The following supervised methods are available in the <em>multiblock</em> package (function names in parentheses):</p>
<ul>
<li>MB-PLS - Multiblock Partial Least Squares (<em>mbpls</em>)</li>
<li>SO-PLS - Sequential and Orthogonalised PLS (<em>sopls</em>)</li>
<li>PO-PLS - Parallel and Orthogonalised PLS (<em>popls</em>)</li>
<li>ROSA - Response Oriented Sequential Alternation (<em>rosa</em>)</li>
<li>mbRDA - Multiblock Redundancy Analysis (<em>mbrda</em>)</li>
</ul>
<p>The following sections will describe how to format your data for analysis and invoke all methods from the list above.</p>
</div>
<div id="formatting-data-for-multiblock-analyses" class="section level1">
<h1 class="hasAnchor">
<a href="#formatting-data-for-multiblock-analyses" class="anchor"></a>Formatting data for multiblock analyses</h1>
<p>Data blocks are best stored as named lists for use with the formula interface of R. The following is an example with sample data in one data block and one response block.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Random data</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span>; <span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">90</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, nrow<span class="op">=</span><span class="va">n</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">+</span> <span class="fl">10</span>

<span class="co"># Split X into three blocks in a named list</span>
<span class="va">ABC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, B <span class="op">=</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">21</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span>, C <span class="op">=</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">51</span><span class="op">:</span><span class="fl">90</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>

<span class="co"># Model using names of blocks (see below for full SO-PLS example)</span>
<span class="va">so.abc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sopls.html">sopls</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span> <span class="op">+</span> <span class="va">C</span>, data <span class="op">=</span> <span class="va">ABC</span>, ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="multiblock-partial-least-squares---mb-pls" class="section level1">
<h1 class="hasAnchor">
<a href="#multiblock-partial-least-squares---mb-pls" class="anchor"></a>Multiblock Partial Least Squares - MB-PLS</h1>
<p>Multiblock PLS is presented briefly using the <em>potato</em> data.</p>
<div id="modelling" class="section level2">
<h2 class="hasAnchor">
<a href="#modelling" class="anchor"></a>Modelling</h2>
<p>A multi-response two-block MB-PLS model with up to 10 components in total is cross-validated with 10 random segments.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">potato</span><span class="op">)</span>
<span class="va">mb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mbpls.html">mbpls</a></span><span class="op">(</span><span class="va">potato</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Chemical'</span>,<span class="st">'Compression'</span><span class="op">)</span><span class="op">]</span>, <span class="va">potato</span><span class="op">[[</span><span class="st">'Sensory'</span><span class="op">]</span><span class="op">]</span>, ncomp <span class="op">=</span> <span class="fl">10</span>,
            max_comps<span class="op">=</span><span class="fl">10</span>, validation<span class="op">=</span><span class="st">"CV"</span>, segments<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span>
<span class="co">#&gt; Multiblock PLS </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mbpls(X = potato[c("Chemical", "Compression")], Y = potato[["Sensory"]],     ncomp = 10, max_comps = 10, validation = "CV", segments = 10)</span></code></pre></div>
</div>
<div id="summaries-and-plotting" class="section level2">
<h2 class="hasAnchor">
<a href="#summaries-and-plotting" class="anchor"></a>Summaries and plotting</h2>
<p>MB-PLS is implemented as a block-wise weighted concatenated ordinary PLSR. Therefore, all methods available for <em>plsr</em> are available for the global part of the MB-PL. In addition one can extrac <em>blockScores</em> and <em>blockLoadings</em>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Tb1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pls/man/scores.html">scores</a></span><span class="op">(</span><span class="va">mb</span>, block<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/scoreplot.html">scoreplot</a></span><span class="op">(</span><span class="va">mb</span>, block <span class="op">=</span> <span class="fl">1</span>, labels <span class="op">=</span> <span class="st">"names"</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_E_supervised_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">Pb2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pls/man/scores.html">loadings</a></span><span class="op">(</span><span class="va">mb</span>, block<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/scoreplot.html">loadingplot</a></span><span class="op">(</span><span class="va">mb</span>, block <span class="op">=</span> <span class="fl">1</span>, labels <span class="op">=</span> <span class="st">"names"</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_E_supervised_files/figure-html/unnamed-chunk-4-2.png" width="576"></p>
</div>
</div>
<div id="sequential-and-orthogonalised-pls---so-pls" class="section level1">
<h1 class="hasAnchor">
<a href="#sequential-and-orthogonalised-pls---so-pls" class="anchor"></a>Sequential and orthogonalised PLS - SO-PLS</h1>
<p>The following example uses the <em>potato</em> data to showcase some of the functions available for SO-PLS analyses.</p>
<div id="modelling-1" class="section level2">
<h2 class="hasAnchor">
<a href="#modelling-1" class="anchor"></a>Modelling</h2>
<p>A multi-response two-block SO-PLS model with up to 10 components in total is cross-validated with 10 random segments.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load potato data and fit SO-PLS model</span>
<span class="va">so.pot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sopls.html">sopls</a></span><span class="op">(</span><span class="va">Sensory</span> <span class="op">~</span> <span class="va">Chemical</span> <span class="op">+</span> <span class="va">Compression</span>, data<span class="op">=</span><span class="va">potato</span>, 
            ncomp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>, max_comps<span class="op">=</span><span class="fl">10</span>, validation<span class="op">=</span><span class="st">"CV"</span>, segments<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">so.pot</span><span class="op">)</span>
<span class="co">#&gt; Sequential and Orthogonalized Partial Least Squares, fitted with the PKPLS algorithm.</span>
<span class="co">#&gt; Cross-validated using 10 random segments.</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; sopls(formula = Sensory ~ Chemical + Compression, ncomp = c(10,     10), max_comps = 10, data = potato, validation = "CV", segments = 10)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">so.pot</span><span class="op">)</span>
<span class="co">#&gt; Data:    X dimension: 26 0 </span>
<span class="co">#&gt;  Y dimension: 26 9</span>
<span class="co">#&gt; Fit method: PKPLS</span>
<span class="co">#&gt; Number of components considered: 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; VALIDATION: RMSEP</span>
<span class="co">#&gt; Cross-validated using 10 random segments.</span>
<span class="co">#&gt;    0,0     0,1     0,2     0,3     0,4     0,5     0,6     0,7     0,8     0,9  </span>
<span class="co">#&gt; 1.1472  0.9974  1.1034  0.9942  1.0159  1.1523  1.0857  1.1834  1.2494  1.3022  </span>
<span class="co">#&gt;   0,10     1,0     1,1     1,2     1,3     1,4     1,5     1,6     1,7     1,8  </span>
<span class="co">#&gt; 1.2690  0.9058  0.8860  0.9779  0.9029  0.8942  0.9320  0.9441  1.0542  1.1243  </span>
<span class="co">#&gt;    1,9     2,0     2,1     2,2     2,3     2,4     2,5     2,6     2,7     2,8  </span>
<span class="co">#&gt; 1.1369  0.8077  0.7023  0.7124  0.7737  0.8072  0.8651  0.8511  0.9742  1.0048  </span>
<span class="co">#&gt;    3,0     3,1     3,2     3,3     3,4     3,5     3,6     3,7     4,0     4,1  </span>
<span class="co">#&gt; 0.7439  0.7275  0.7111  0.7716  0.8322  0.8846  0.8893  0.9793  0.7494  0.7165  </span>
<span class="co">#&gt;    4,2     4,3     4,4     4,5     4,6     5,0     5,1     5,2     5,3     5,4  </span>
<span class="co">#&gt; 0.7272  0.7748  0.8135  0.9157  0.9001  0.7752  0.7491  0.7593  0.8494  0.9693  </span>
<span class="co">#&gt;    5,5     6,0     6,1     6,2     6,3     6,4     7,0     7,1     7,2     7,3  </span>
<span class="co">#&gt; 1.0306  0.8504  0.8438  0.8198  0.9304  1.0222  0.8997  0.8910  0.8418  0.9632  </span>
<span class="co">#&gt;    8,0     8,1     8,2     9,0     9,1    10,0  </span>
<span class="co">#&gt; 1.0062  1.0033  0.9511  1.0682  1.0557  1.6371  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; TRAINING: % variance explained</span>
<span class="co">#&gt;         0,0    0,1    0,2    0,3    0,4    0,5    0,6    0,7    0,8    0,9</span>
<span class="co">#&gt; X         0  45.87  55.51  62.90  66.46  67.73  74.95  78.26  79.85  82.39</span>
<span class="co">#&gt; ref       0  42.19  54.73  65.01  66.85  73.96  74.10  74.44  77.45  77.57</span>
<span class="co">#&gt; hard      0  39.11  41.97  42.23  43.80  50.95  54.87  56.78  59.50  74.53</span>
<span class="co">#&gt; firm      0  42.55  57.44  59.44  61.06  66.78  68.62  69.02  71.34  76.53</span>
<span class="co">#&gt; elas      0  38.64  65.31  73.51  75.63  77.23  79.25  81.19  83.71  86.57</span>
<span class="co">#&gt; adhes     0  16.13  18.11  26.71  26.74  29.70  42.07  44.57  46.47  46.54</span>
<span class="co">#&gt; grainy    0  23.21  43.78  62.23  64.02  67.18  67.72  69.83  74.79  74.79</span>
<span class="co">#&gt; mealy     0  35.35  41.99  57.36  58.84  67.17  70.33  73.21  77.77  78.88</span>
<span class="co">#&gt; moist     0  24.48  27.71  43.10  44.27  48.41  53.39  62.37  67.60  74.79</span>
<span class="co">#&gt; chewi     0  21.98  22.78  48.17  55.50  59.96  68.39  72.54  76.39  77.42</span>
<span class="co">#&gt;          0,10    1,0    1,1    1,2    1,3    1,4    1,5    1,6    1,7    1,8</span>
<span class="co">#&gt; X       83.18  34.20  64.12  71.71  76.24  78.20  79.49  83.37  84.42  85.59</span>
<span class="co">#&gt; ref     77.57  55.79  64.00  64.25  73.75  77.39  79.53  80.42  80.50  80.96</span>
<span class="co">#&gt; hard    75.43  24.10  41.42  44.05  44.07  44.09  47.61  53.70  53.86  62.46</span>
<span class="co">#&gt; firm    79.31  42.73  54.16  58.42  62.05  63.55  64.91  70.85  70.91  70.93</span>
<span class="co">#&gt; elas    88.14  53.24  59.32  63.95  71.43  74.51  75.33  77.16  78.86  78.88</span>
<span class="co">#&gt; adhes   54.68  17.49  22.70  33.54  33.75  34.70  34.90  39.43  48.51  48.92</span>
<span class="co">#&gt; grainy  74.82  57.69  58.26  58.39  71.89  75.95  76.07  76.72  77.73  79.00</span>
<span class="co">#&gt; mealy   79.25  61.37  65.64  66.70  74.33  75.36  77.44  78.35  79.55  80.15</span>
<span class="co">#&gt; moist   77.22  57.32  58.51  62.12  66.20  66.35  67.13  67.14  69.51  71.02</span>
<span class="co">#&gt; chewi   81.68  53.27  54.25  64.22  66.35  69.59  69.96  72.80  77.64  77.64</span>
<span class="co">#&gt;           1,9    2,0    2,1    2,2    2,3    2,4    2,5    2,6    2,7    2,8</span>
<span class="co">#&gt; X       86.07  42.76  72.61  79.40  81.41  82.69  84.98  88.16  88.87  89.84</span>
<span class="co">#&gt; ref     81.20  76.03  85.17  87.21  89.03  90.67  90.68  91.36  91.36  91.39</span>
<span class="co">#&gt; hard    69.98  25.29  44.10  46.63  46.63  46.88  52.03  61.89  64.48  73.84</span>
<span class="co">#&gt; firm    80.21  55.93  69.19  76.45  76.45  76.80  77.79  82.58  82.64  86.03</span>
<span class="co">#&gt; elas    87.63  63.10  70.21  78.03  78.08  78.17  80.37  82.19  84.54  85.69</span>
<span class="co">#&gt; adhes   49.97  34.43  39.48  46.70  46.78  48.48  54.50  56.16  67.45  72.74</span>
<span class="co">#&gt; grainy  79.50  83.95  84.78  87.19  88.01  88.56  89.28  89.29  89.30  89.49</span>
<span class="co">#&gt; mealy   80.19  81.14  85.67  85.68  87.94  88.28  88.57  89.15  89.69  90.49</span>
<span class="co">#&gt; moist   72.44  67.94  69.06  70.49  72.51  72.53  72.61  72.80  73.61  78.69</span>
<span class="co">#&gt; chewi   78.05  70.55  71.41  77.11  77.11  78.09  78.17  79.79  83.27  86.51</span>
<span class="co">#&gt;           3,0    3,1    3,2    3,3    3,4    3,5    3,6    3,7    4,0    4,1</span>
<span class="co">#&gt; X       63.76  78.59  84.55  86.77  87.73  90.09  91.81  92.46  70.09  80.35</span>
<span class="co">#&gt; ref     84.50  86.31  87.91  89.34  91.72  91.74  93.12  93.13  84.91  87.28</span>
<span class="co">#&gt; hard    29.51  45.43  50.00  50.23  51.56  54.69  61.12  63.12  30.80  49.39</span>
<span class="co">#&gt; firm    62.42  68.64  76.93  76.96  77.84  78.25  82.67  82.72  62.64  73.46</span>
<span class="co">#&gt; elas    69.44  70.75  78.04  78.06  78.07  80.60  82.75  85.36  69.94  73.16</span>
<span class="co">#&gt; adhes   34.51  46.88  50.83  51.04  51.60  57.45  58.26  69.10  64.76  65.66</span>
<span class="co">#&gt; grainy  87.18  87.45  88.87  89.86  90.34  91.06  91.37  91.45  87.20  87.21</span>
<span class="co">#&gt; mealy   84.89  86.14  86.18  88.32  89.25  89.48  91.02  91.95  88.83  88.96</span>
<span class="co">#&gt; moist   70.03  70.05  72.13  74.57  74.71  74.88  74.97  76.40  75.09  76.33</span>
<span class="co">#&gt; chewi   70.56  72.61  77.34  77.39  78.58  78.58  79.89  83.77  82.06  82.29</span>
<span class="co">#&gt;           4,2    4,3    4,4    4,5    4,6    5,0    5,1    5,2    5,3    5,4</span>
<span class="co">#&gt; X       87.12  88.89  89.78  92.03  93.37  75.21  84.27  91.16  92.52  93.47</span>
<span class="co">#&gt; ref     88.13  89.65  92.48  92.54  93.63  85.03  88.23  89.16  90.27  92.85</span>
<span class="co">#&gt; hard    49.95  50.65  50.76  54.96  60.99  41.38  53.88  54.08  54.33  54.70</span>
<span class="co">#&gt; firm    77.00  77.10  77.44  78.23  83.34  68.24  75.97  78.78  78.78  79.40</span>
<span class="co">#&gt; elas    78.98  79.09  79.43  82.78  83.85  72.35  74.56  79.87  80.48  80.91</span>
<span class="co">#&gt; adhes   67.28  68.26  69.21  70.41  70.90  64.77  65.81  67.35  67.83  69.01</span>
<span class="co">#&gt; grainy  89.07  90.46  91.63  92.15  92.30  87.53  87.56  89.67  90.98  91.93</span>
<span class="co">#&gt; mealy   88.99  93.13  94.52  94.64  95.00  89.21  89.65  89.73  93.45  94.51</span>
<span class="co">#&gt; moist   76.60  82.33  82.90  82.90  83.28  79.72  79.91  79.98  83.86  84.08</span>
<span class="co">#&gt; chewi   84.08  84.45  86.24  86.38  86.39  82.11  82.31  83.97  84.76  86.45</span>
<span class="co">#&gt;           5,5    6,0    6,1    6,2    6,3    6,4    7,0    7,1    7,2    7,3</span>
<span class="co">#&gt; X       95.40  77.28  86.22  93.18  94.55  95.63  79.57  88.43  95.46  96.65</span>
<span class="co">#&gt; ref     92.91  86.80  90.43  91.47  92.26  94.07  88.07  91.60  92.62  92.70</span>
<span class="co">#&gt; hard    60.53  45.27  56.94  57.05  57.64  59.71  45.28  56.91  56.99  57.22</span>
<span class="co">#&gt; firm    80.75  68.98  76.56  79.17  79.42  80.55  69.02  76.72  79.16  79.35</span>
<span class="co">#&gt; elas    83.34  72.55  74.96  80.08  80.15  80.26  73.76  76.39  81.36  81.61</span>
<span class="co">#&gt; adhes   70.53  64.77  65.79  67.29  69.17  69.37  65.04  65.96  67.53  68.89</span>
<span class="co">#&gt; grainy  92.38  91.29  91.41  93.80  94.06  94.27  91.78  91.89  94.29  94.34</span>
<span class="co">#&gt; mealy   94.83  90.67  91.24  91.36  94.83  95.44  92.38  92.87  92.98  94.77</span>
<span class="co">#&gt; moist   84.08  82.80  82.90  82.93  85.65  85.67  85.12  85.26  85.29  86.55</span>
<span class="co">#&gt; chewi   86.50  84.60  84.72  86.16  86.49  87.50  86.05  86.22  87.61  87.62</span>
<span class="co">#&gt;           8,0    8,1    8,2    9,0    9,1   10,0</span>
<span class="co">#&gt; X       82.82  88.16  95.96  85.49  90.21  87.08</span>
<span class="co">#&gt; ref     90.82  94.67  94.93  91.52  94.42  91.79</span>
<span class="co">#&gt; hard    52.73  59.90  60.33  52.75  63.37  52.92</span>
<span class="co">#&gt; firm    71.26  80.42  80.49  71.81  80.88  71.82</span>
<span class="co">#&gt; elas    73.78  80.71  81.41  75.22  80.15  76.14</span>
<span class="co">#&gt; adhes   68.88  68.89  69.28  71.74  72.73  74.17</span>
<span class="co">#&gt; grainy  91.80  93.21  94.39  91.99  92.91  92.43</span>
<span class="co">#&gt; mealy   93.59  94.05  94.31  93.75  93.98  93.83</span>
<span class="co">#&gt; moist   86.40  86.60  87.34  87.11  88.40  87.14</span>
<span class="co">#&gt; chewi   87.11  88.40  88.43  87.27  89.53  87.28</span></code></pre></div>
</div>
<div id="måge-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#m%C3%A5ge-plot" class="anchor"></a>Måge plot</h2>
<p>Full Måge plot for all combinations of components for all blocks. This can be used for a global search for the best fitting cross-validated model.</p>
<p>Each point in the figure below is accompanied by a sequence of four numbers referring to the number of components used for each of the four blocks. Horizontal location is given by the total number of components used across all blocks, while vertical location indicates validated explained variance in percentage.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load Wine data and model with SO-PLS</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">wine</span><span class="op">)</span>
<span class="va">ncomp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">wine</span>, <span class="va">ncol</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">5</span><span class="op">]</span>
<span class="va">so.wine</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sopls.html">sopls</a></span><span class="op">(</span><span class="va">`Global quality`</span> <span class="op">~</span> <span class="va">.</span>, data<span class="op">=</span><span class="va">wine</span>, ncomp<span class="op">=</span><span class="va">ncomp</span>, 
             max_comps<span class="op">=</span><span class="fl">6</span>, validation<span class="op">=</span><span class="st">"CV"</span>, segments<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="../reference/maage.html">maage</a></span><span class="op">(</span><span class="va">so.wine</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_E_supervised_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<p>A sequential Måge plot can be used for a sequential search for the optimal model.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Sequential search for optimal number of components per block</span>
<span class="va">old.par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0.7</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/maage.html">maageSeq</a></span><span class="op">(</span><span class="va">so.wine</span><span class="op">)</span>
<span class="fu"><a href="../reference/maage.html">maageSeq</a></span><span class="op">(</span><span class="va">so.wine</span>, <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/maage.html">maageSeq</a></span><span class="op">(</span><span class="va">so.wine</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/maage.html">maageSeq</a></span><span class="op">(</span><span class="va">so.wine</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_E_supervised_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">old.par</span><span class="op">)</span></code></pre></div>
</div>
<div id="loadings" class="section level2">
<h2 class="hasAnchor">
<a href="#loadings" class="anchor"></a>Loadings</h2>
<p>One set of loadings is printed and two sets are plotted to show how to select specific components from specific blocks.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Display loadings for first block</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/scores.html">loadings</a></span><span class="op">(</span><span class="va">so.pot</span>, block <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Loadings:</span>
<span class="co">#&gt;              1,0    2,0    3,0    4,0    5,0    6,0    7,0    8,0    9,0   </span>
<span class="co">#&gt; ChemicalPEU   0.645 -3.672  1.197  2.277 -0.589 -1.684  1.028  0.431  0.118</span>
<span class="co">#&gt; ChemicalSta. -4.542 -0.975 -0.984 -0.678 -0.559 -0.926 -0.418 -0.583  0.508</span>
<span class="co">#&gt; ChemicalTotN  0.478 -1.848  3.046 -1.613  1.604 -1.088  1.441  0.355 -1.874</span>
<span class="co">#&gt; ChemicalPhy. -3.970        -1.445  0.948  1.148 -0.286  1.519 -0.669  0.233</span>
<span class="co">#&gt; ChemicalCa   -1.365 -0.982  1.804 -1.190 -3.763  1.249  0.107  0.281 -0.401</span>
<span class="co">#&gt; ChemicalMg   -4.009 -0.280        -2.344  0.996 -0.320  1.152  0.172  0.801</span>
<span class="co">#&gt; ChemicalNa   -3.066 -2.488  0.669  1.616 -1.119  1.520 -0.570 -0.430 -0.452</span>
<span class="co">#&gt; ChemicalK    -0.186 -0.255 -4.161  0.149  0.700  1.225 -1.469  1.284 -1.263</span>
<span class="co">#&gt; ChemicalHi.1 -4.493  2.113         0.344 -0.226        -0.126  0.108 -0.154</span>
<span class="co">#&gt; ChemicalHi.2 -4.099  2.656 -0.739  0.488 -0.311 -0.225  0.135  0.120 -0.254</span>
<span class="co">#&gt; ChemicalHi.3 -4.382  2.270 -0.259  0.398 -0.272 -0.271  0.105  0.337 -0.369</span>
<span class="co">#&gt; ChemicalHi.4  3.000  0.732 -2.855        -1.994 -0.483  1.552 -0.173 -0.200</span>
<span class="co">#&gt; ChemicalHi.5 -4.419  2.023 -0.177  0.372 -0.362 -0.359  0.192  0.494 -0.668</span>
<span class="co">#&gt; ChemicalHi.6  1.580  2.266 -3.570  0.571 -1.131 -0.664  1.351 -0.390 -0.371</span>
<span class="co">#&gt;              10,0  </span>
<span class="co">#&gt; ChemicalPEU  -0.132</span>
<span class="co">#&gt; ChemicalSta.  0.220</span>
<span class="co">#&gt; ChemicalTotN       </span>
<span class="co">#&gt; ChemicalPhy. -1.415</span>
<span class="co">#&gt; ChemicalCa   -1.229</span>
<span class="co">#&gt; ChemicalMg    0.481</span>
<span class="co">#&gt; ChemicalNa    1.440</span>
<span class="co">#&gt; ChemicalK    -0.411</span>
<span class="co">#&gt; ChemicalHi.1  0.162</span>
<span class="co">#&gt; ChemicalHi.2  0.146</span>
<span class="co">#&gt; ChemicalHi.3       </span>
<span class="co">#&gt; ChemicalHi.4  0.528</span>
<span class="co">#&gt; ChemicalHi.5       </span>
<span class="co">#&gt; ChemicalHi.6  0.279</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                    1,0    2,0    3,0    4,0    5,0    6,0    7,0    8,0    9,0</span>
<span class="co">#&gt; SS loadings    151.624 51.586 56.326 19.671 27.054 11.370 13.749  3.605  7.288</span>
<span class="co">#&gt; Proportion Var  10.830  3.685  4.023  1.405  1.932  0.812  0.982  0.257  0.521</span>
<span class="co">#&gt; Cumulative Var  10.830 14.515 18.538 19.943 21.876 22.688 23.670 23.927 24.448</span>
<span class="co">#&gt;                  10,0</span>
<span class="co">#&gt; SS loadings     6.470</span>
<span class="co">#&gt; Proportion Var  0.462</span>
<span class="co">#&gt; Cumulative Var 24.910</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot loadings from block 1 and 2</span>
<span class="va">old.par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/scoreplot.html">loadingplot</a></span><span class="op">(</span><span class="va">so.pot</span>, comps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, block <span class="op">=</span> <span class="fl">1</span>, main <span class="op">=</span> <span class="st">"Block 1"</span>, labels <span class="op">=</span> <span class="st">"names"</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/scoreplot.html">loadingplot</a></span><span class="op">(</span><span class="va">so.pot</span>, ncomp <span class="op">=</span> <span class="fl">4</span>, block <span class="op">=</span> <span class="fl">2</span>, main <span class="op">=</span> <span class="st">"Block 2"</span>, labels <span class="op">=</span> <span class="st">"names"</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_E_supervised_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">old.par</span><span class="op">)</span></code></pre></div>
</div>
<div id="scores" class="section level2">
<h2 class="hasAnchor">
<a href="#scores" class="anchor"></a>Scores</h2>
<p>One set of scores is printed and two sets are plotted to show how to select specific components from specific blocks.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Display scores for first block</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/scores.html">scores</a></span><span class="op">(</span><span class="va">so.pot</span>, block <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt;             1,0         2,0          3,0         4,0         5,0          6,0</span>
<span class="co">#&gt; 1  -0.078379126 -0.15756558 -0.030150796 -0.08882899 -0.01376296 -0.056671801</span>
<span class="co">#&gt; 2   0.033599245  0.03345139 -0.264837392 -0.02082345 -0.11717078 -0.151392736</span>
<span class="co">#&gt; 3  -0.454087240 -0.50387774 -0.257625630  0.24822188 -0.02903093 -0.086528935</span>
<span class="co">#&gt; 4  -0.010144029  0.04409907  0.254739277  0.34206013  0.02495265  0.074552441</span>
<span class="co">#&gt; 5  -0.231320589  0.02813994  0.331647163 -0.15209020 -0.75827354  0.341572360</span>
<span class="co">#&gt; 6  -0.100806072 -0.03203490  0.058511494 -0.07824489 -0.03272086  0.022355259</span>
<span class="co">#&gt; 7   0.103759602  0.05587580  0.171495995  0.13245956 -0.01979756 -0.159062060</span>
<span class="co">#&gt; 8   0.142341829 -0.02952316  0.135315864  0.17766566 -0.04381490 -0.186272842</span>
<span class="co">#&gt; 9   0.160175421 -0.13395363  0.067732083 -0.34567441  0.17107748  0.172779015</span>
<span class="co">#&gt; 10  0.078862890 -0.20282246  0.065251294 -0.21205811  0.20044571  0.328237338</span>
<span class="co">#&gt; 11  0.200245777 -0.02882659  0.149667777 -0.08872396 -0.08768916 -0.174332305</span>
<span class="co">#&gt; 12  0.223602068 -0.07321286 -0.029748834 -0.22950703 -0.03709102 -0.193124707</span>
<span class="co">#&gt; 13  0.217320106 -0.26815383  0.096949900 -0.10070260  0.05733144 -0.253089620</span>
<span class="co">#&gt; 14  0.142847549 -0.29951537  0.077252287  0.24996525 -0.11362892 -0.187257376</span>
<span class="co">#&gt; 15  0.213820293  0.17228886 -0.461863019 -0.11767172 -0.27195381 -0.069378444</span>
<span class="co">#&gt; 16  0.164964325  0.26005269 -0.323577542  0.10235857 -0.18083698  0.028860577</span>
<span class="co">#&gt; 17  0.002967383  0.19480792 -0.246885356  0.19701818  0.05083294  0.193040181</span>
<span class="co">#&gt; 18  0.066258347  0.09356886 -0.228532411  0.20484080  0.06435515  0.193713440</span>
<span class="co">#&gt; 19  0.194213760 -0.01568159  0.132000297  0.14447620  0.07380230  0.134307084</span>
<span class="co">#&gt; 20  0.141301554 -0.07654188  0.049224760  0.26084474  0.16978368  0.406994445</span>
<span class="co">#&gt; 21 -0.129888279  0.04471652  0.038982799 -0.30565064  0.07729299 -0.272193959</span>
<span class="co">#&gt; 22 -0.105636544  0.24576605 -0.030041538 -0.14535670  0.24832087  0.010288729</span>
<span class="co">#&gt; 23 -0.464479945 -0.11433433 -0.194275154 -0.06714686  0.13063332 -0.005785022</span>
<span class="co">#&gt; 24 -0.082441922  0.22751259  0.233417343  0.13675311  0.22568931 -0.091378804</span>
<span class="co">#&gt; 25 -0.325181587  0.44765983  0.208213841  0.07217114  0.05115869 -0.267361478</span>
<span class="co">#&gt; 26 -0.103914818  0.08810440 -0.002864502 -0.31635566  0.16009487  0.247129222</span>
<span class="co">#&gt;             7,0          8,0         9,0         10,0</span>
<span class="co">#&gt; 1  -0.170176673 -0.353657625  0.09144069 -0.188197767</span>
<span class="co">#&gt; 2   0.376363608 -0.223166913 -0.06432803  0.102154561</span>
<span class="co">#&gt; 3   0.053642203  0.053088656  0.11136825  0.089274658</span>
<span class="co">#&gt; 4   0.080021975 -0.455836399  0.29151166  0.160435908</span>
<span class="co">#&gt; 5   0.060316124  0.088814534 -0.01259842 -0.241887363</span>
<span class="co">#&gt; 6  -0.143868448  0.209487156  0.44247087  0.460290223</span>
<span class="co">#&gt; 7  -0.067499572  0.172789197 -0.01007070  0.014280187</span>
<span class="co">#&gt; 8   0.003023123  0.020901351 -0.15855793  0.115799243</span>
<span class="co">#&gt; 9   0.099124600  0.077168263 -0.22926057  0.020019625</span>
<span class="co">#&gt; 10 -0.006546077  0.001048562 -0.15821313  0.090958585</span>
<span class="co">#&gt; 11 -0.321845257 -0.388050068 -0.15769574  0.033224651</span>
<span class="co">#&gt; 12 -0.114302438 -0.157344716  0.01456158 -0.118230072</span>
<span class="co">#&gt; 13  0.159102296  0.426179096  0.31221443 -0.244022144</span>
<span class="co">#&gt; 14  0.164565349  0.160117465 -0.31148972  0.004138940</span>
<span class="co">#&gt; 15  0.160269738 -0.034424824  0.04760954  0.177518448</span>
<span class="co">#&gt; 16  0.073035199  0.028396505  0.02512587  0.008674474</span>
<span class="co">#&gt; 17 -0.336494502  0.228154141 -0.02760929 -0.191196309</span>
<span class="co">#&gt; 18 -0.353315626  0.070825686  0.13990043 -0.255631862</span>
<span class="co">#&gt; 19 -0.192020302  0.118534017 -0.05488875  0.206887988</span>
<span class="co">#&gt; 20  0.167499146 -0.065961803 -0.17176149 -0.018385084</span>
<span class="co">#&gt; 21 -0.291917226 -0.005778312  0.06774798 -0.093267865</span>
<span class="co">#&gt; 22  0.315505112  0.055322691 -0.04212437 -0.272120565</span>
<span class="co">#&gt; 23 -0.070388026 -0.103937894 -0.28625584 -0.102958571</span>
<span class="co">#&gt; 24  0.271169417 -0.112282869  0.28534458 -0.337006550</span>
<span class="co">#&gt; 25 -0.033293058  0.199555988 -0.33284978  0.259557484</span>
<span class="co">#&gt; 26  0.118029313 -0.009941885  0.18840789  0.319689179</span>
<span class="co">#&gt; attr(,"explvar")</span>
<span class="co">#&gt;       1,0       2,0       3,0       4,0       5,0       6,0       7,0       8,0 </span>
<span class="co">#&gt; 34.201725  8.556741 20.999993  6.330308  5.124745  2.071311  2.284023  3.250427 </span>
<span class="co">#&gt;       9,0      10,0 </span>
<span class="co">#&gt;  2.674759  1.582372 </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "scores.multiblock" "scores"</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot scores from block 1 and 2</span>
<span class="va">old.par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/scoreplot.html">scoreplot</a></span><span class="op">(</span><span class="va">so.pot</span>, comps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, block <span class="op">=</span> <span class="fl">1</span>, main <span class="op">=</span> <span class="st">"Block 1"</span>, labels <span class="op">=</span> <span class="st">"names"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/scoreplot.html">scoreplot</a></span><span class="op">(</span><span class="va">so.pot</span>, ncomp <span class="op">=</span> <span class="fl">4</span>, block <span class="op">=</span> <span class="fl">2</span>, main <span class="op">=</span> <span class="st">"Block 2"</span>, labels <span class="op">=</span> <span class="st">"names"</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_E_supervised_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">old.par</span><span class="op">)</span></code></pre></div>
</div>
<div id="prediction" class="section level2">
<h2 class="hasAnchor">
<a href="#prediction" class="anchor"></a>Prediction</h2>
<p>A three block model is fitted using a single response, 5 components and a subset of the data. The remaining data are used as test set for prediction.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Modify data to contain a single response</span>
<span class="va">potato1</span> <span class="op">&lt;-</span> <span class="va">potato</span>; <span class="va">potato1</span><span class="op">$</span><span class="va">Sensory</span> <span class="op">&lt;-</span> <span class="va">potato1</span><span class="op">$</span><span class="va">Sensory</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="co"># Model 20 first objects with SO-PLS</span>
<span class="va">so.pot20</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sopls.html">sopls</a></span><span class="op">(</span><span class="va">Sensory</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">potato1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">9</span><span class="op">)</span><span class="op">]</span>, ncomp <span class="op">=</span> <span class="fl">5</span>, subset <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>
<span class="co"># Predict remaining objects</span>
<span class="va">testset</span> <span class="op">&lt;-</span> <span class="va">potato1</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>,<span class="op">]</span>; <span class="co"># testset$Sensory &lt;- NULL</span>
<span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">so.pot20</span>, <span class="va">testset</span>, comps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; , , 1,0,0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       Sensory</span>
<span class="co">#&gt; [1,] 3.922829</span>
<span class="co">#&gt; [2,] 3.801854</span>
<span class="co">#&gt; [3,] 6.409450</span>
<span class="co">#&gt; [4,] 2.960830</span>
<span class="co">#&gt; [5,] 4.433857</span>
<span class="co">#&gt; [6,] 3.223006</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , 2,0,0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       Sensory</span>
<span class="co">#&gt; [1,] 4.062985</span>
<span class="co">#&gt; [2,] 4.238679</span>
<span class="co">#&gt; [3,] 7.178207</span>
<span class="co">#&gt; [4,] 2.477011</span>
<span class="co">#&gt; [5,] 3.319856</span>
<span class="co">#&gt; [6,] 2.904183</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , 2,1,0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       Sensory</span>
<span class="co">#&gt; [1,] 4.169790</span>
<span class="co">#&gt; [2,] 4.471989</span>
<span class="co">#&gt; [3,] 7.282654</span>
<span class="co">#&gt; [4,] 2.426714</span>
<span class="co">#&gt; [5,] 3.273465</span>
<span class="co">#&gt; [6,] 2.898753</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , 2,1,1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Sensory</span>
<span class="co">#&gt; [1,]  5.2214087</span>
<span class="co">#&gt; [2,]  5.1427034</span>
<span class="co">#&gt; [3,]  9.7861678</span>
<span class="co">#&gt; [4,] -0.7742392</span>
<span class="co">#&gt; [5,]  0.9645707</span>
<span class="co">#&gt; [6,]  2.2666501</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , 2,1,2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Sensory</span>
<span class="co">#&gt; [1,]  5.4727706</span>
<span class="co">#&gt; [2,]  5.5669734</span>
<span class="co">#&gt; [3,] 11.3237645</span>
<span class="co">#&gt; [4,] -2.3105720</span>
<span class="co">#&gt; [5,]  0.2755925</span>
<span class="co">#&gt; [6,]  2.1649361</span></code></pre></div>
</div>
<div id="validation" class="section level2">
<h2 class="hasAnchor">
<a href="#validation" class="anchor"></a>Validation</h2>
<p>Compute validation statistics; explained variance - R<span class="math inline">\(^2\)</span> and Root Mean Squared Error - RMSE(P/CV).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Cross-validation</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvrVal.html">R2</a></span><span class="op">(</span><span class="va">so.pot</span>, ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;        1,0        2,0        3,0        4,0        5,0        5,1        5,2 </span>
<span class="co">#&gt; 0.29491711 0.43937819 0.52443674 0.51731500 0.48356727 0.51769239 0.50453909 </span>
<span class="co">#&gt;        5,3        5,4        5,5 </span>
<span class="co">#&gt; 0.37995426 0.19264375 0.08718665</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvrVal.html">R2</a></span><span class="op">(</span><span class="va">so.pot</span>, ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>, individual <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;                1,0         2,0         3,0          4,0         5,0        5,1</span>
<span class="co">#&gt; ref     0.27825536  0.43256997  0.60854575  0.611650546  0.57962221  0.6410025</span>
<span class="co">#&gt; hard   -0.01534472 -0.19976337 -0.32629673 -0.629670315 -0.73850234 -0.5385860</span>
<span class="co">#&gt; firm    0.11456699  0.11663849  0.14175670 -0.005647699  0.07172321  0.2173452</span>
<span class="co">#&gt; elas    0.32922325  0.39196816  0.41920590  0.347290927  0.35236475  0.3873415</span>
<span class="co">#&gt; adhes  -0.04074410  0.02924686 -0.06114012  0.182892958  0.21626890  0.2398021</span>
<span class="co">#&gt; grainy  0.29892446  0.57657563  0.70726840  0.720648990  0.66998154  0.6426785</span>
<span class="co">#&gt; mealy   0.39732737  0.60662586  0.71089974  0.742956337  0.70442569  0.7074522</span>
<span class="co">#&gt; moist   0.42596297  0.55819542  0.60651611  0.602672591  0.54129827  0.5169465</span>
<span class="co">#&gt; chewi   0.38811017  0.58159817  0.56193588  0.643390275  0.56225915  0.5417198</span>
<span class="co">#&gt;               5,2         5,3         5,4         5,5</span>
<span class="co">#&gt; ref     0.6892006  0.64474046  0.66948387  0.69542145</span>
<span class="co">#&gt; hard   -0.6078491 -1.37218409 -2.90610544 -4.13991040</span>
<span class="co">#&gt; firm    0.2464953 -0.01322888 -0.26416572 -0.69554952</span>
<span class="co">#&gt; elas    0.4649800  0.43158366  0.45223779  0.09663100</span>
<span class="co">#&gt; adhes   0.1548038 -0.06098741 -0.71470005 -1.01032999</span>
<span class="co">#&gt; grainy  0.6653825  0.67115458  0.67261140  0.75006427</span>
<span class="co">#&gt; mealy   0.6671254  0.62578581  0.60276444  0.67661249</span>
<span class="co">#&gt; moist   0.3843608  0.12290559 -0.34127485 -0.48130723</span>
<span class="co">#&gt; chewi   0.4645314  0.35373420  0.06156931  0.07770671</span>
<span class="co"># Training</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvrVal.html">R2</a></span><span class="op">(</span><span class="va">so.pot</span>, <span class="st">'train'</span>, ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;       1,0       2,0       3,0       4,0       5,0       5,1       5,2       5,3 </span>
<span class="co">#&gt; 0.5321195 0.7063309 0.7545212 0.7890377 0.8065415 0.8303087 0.8419431 0.8603538 </span>
<span class="co">#&gt;       5,4       5,5 </span>
<span class="co">#&gt; 0.8735251 0.8807225</span>

<span class="co"># Test data</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvrVal.html">R2</a></span><span class="op">(</span><span class="va">so.pot20</span>, newdata <span class="op">=</span> <span class="va">testset</span>, ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;      1,0,0      2,0,0      2,1,0      2,1,1      2,1,2 </span>
<span class="co">#&gt;  0.5217279  0.7330829  0.7208834  0.4494703 -0.2607736</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Cross-validation</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvrVal.html">RMSEP</a></span><span class="op">(</span><span class="va">so.pot</span>, ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;       1,0       2,0       3,0       4,0       5,0       5,1       5,2       5,3 </span>
<span class="co">#&gt; 0.9057837 0.8076801 0.7438897 0.7494390 0.7751956 0.7491460 0.7592925 0.8494079 </span>
<span class="co">#&gt;       5,4       5,5 </span>
<span class="co">#&gt; 0.9692527 1.0306125</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvrVal.html">RMSEP</a></span><span class="op">(</span><span class="va">so.pot</span>, ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>, individual <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;              1,0       2,0       3,0       4,0       5,0       5,1       5,2</span>
<span class="co">#&gt; ref    1.4521251 1.2875627 1.0694309 1.0651814 1.1082357 1.0241368 0.9529110</span>
<span class="co">#&gt; hard   0.7409166 0.8053977 0.8468041 0.9386690 0.9695054 0.9120602 0.9323634</span>
<span class="co">#&gt; firm   0.8153675 0.8144132 0.8027508 0.8689574 0.8348612 0.7665856 0.7521744</span>
<span class="co">#&gt; elas   0.5987744 0.5700821 0.5571669 0.5906552 0.5883550 0.5722469 0.5347604</span>
<span class="co">#&gt; adhes  0.6238669 0.6025240 0.6299503 0.5527890 0.5413816 0.5331916 0.5622102</span>
<span class="co">#&gt; grainy 0.9124005 0.7090731 0.5895734 0.5759413 0.6259969 0.6513774 0.6303437</span>
<span class="co">#&gt; mealy  1.1918516 0.9629070 0.8254784 0.7783679 0.8346700 0.8303858 0.8857717</span>
<span class="co">#&gt; moist  0.8218611 0.7210138 0.6804434 0.6837585 0.7346723 0.7539214 0.8511216</span>
<span class="co">#&gt; chewi  0.6207792 0.5133308 0.5252540 0.4739114 0.5250602 0.5372372 0.5807210</span>
<span class="co">#&gt;              5,3       5,4       5,5</span>
<span class="co">#&gt; ref    1.0187910 0.9826720 0.9433262</span>
<span class="co">#&gt; hard   1.1324963 1.4532307 1.6670183</span>
<span class="co">#&gt; firm   0.8722266 0.9742660 1.1283161</span>
<span class="co">#&gt; elas   0.5511978 0.5410909 0.6948752</span>
<span class="co">#&gt; adhes  0.6299050 0.8007815 0.8670689</span>
<span class="co">#&gt; grainy 0.6248834 0.6234977 0.5447751</span>
<span class="co">#&gt; mealy  0.9391643 0.9676215 0.8730579</span>
<span class="co">#&gt; moist  1.0159016 1.2562827 1.3202345</span>
<span class="co">#&gt; chewi  0.6379786 0.7687792 0.7621405</span>
<span class="co"># Training</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvrVal.html">RMSEP</a></span><span class="op">(</span><span class="va">so.pot</span>, <span class="st">'train'</span>, ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;       1,0       2,0       3,0       4,0       5,0       5,1       5,2       5,3 </span>
<span class="co">#&gt; 0.7378564 0.5845659 0.5344553 0.4954580 0.4744585 0.4443592 0.4288556 0.4031058 </span>
<span class="co">#&gt;       5,4       5,5 </span>
<span class="co">#&gt; 0.3836247 0.3725492</span>

<span class="co"># Test data</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvrVal.html">RMSEP</a></span><span class="op">(</span><span class="va">so.pot20</span>, newdata <span class="op">=</span> <span class="va">testset</span>, ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;    1,0,0    2,0,0    2,1,0    2,1,1    2,1,2 </span>
<span class="co">#&gt; 1.562727 1.167438 1.193819 1.676625 2.537255</span></code></pre></div>
</div>
</div>
<div id="parallel-and-orthgonalised-partial-least-squares---po-pls" class="section level1">
<h1 class="hasAnchor">
<a href="#parallel-and-orthgonalised-partial-least-squares---po-pls" class="anchor"></a>Parallel and Orthgonalised Partial Least Squares - PO-PLS</h1>
<p>PO-PLS is presented briefly using the <em>potato</em> data.</p>
<div id="modelling-2" class="section level2">
<h2 class="hasAnchor">
<a href="#modelling-2" class="anchor"></a>Modelling</h2>
<p>There are many choices with regard to numbers of components and possible local and common components. Using automatic selection, the user selects the highest number of blocks to combine into local/common components, minimum explained variance and minimum squared correlation to the response. Manual selection is limited to setting the number of initial components from the blocks and maximum number of local/common components.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Automatic analysis</span>
<span class="va">pot.po.auto</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/popls.html">popls</a></span><span class="op">(</span><span class="va">potato</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">potato</span><span class="op">[[</span><span class="st">'Sensory'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, commons <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="co"># Explained variance</span>
<span class="va">pot.po.auto</span><span class="op">$</span><span class="va">explVar</span>
<span class="co">#&gt; $Chemical</span>
<span class="co">#&gt; named numeric(0)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Compression</span>
<span class="co">#&gt; C(1,2), Comp 1 </span>
<span class="co">#&gt;       68.14595 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $NIRraw</span>
<span class="co">#&gt; named numeric(0)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Manual choice of up to 5 components for each block and 1, 0, and 2 blocks,</span>
<span class="co"># respectively from the (1,2), (1,3) and (2,3) combinations of blocks.</span>
<span class="va">pot.po.man</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/popls.html">popls</a></span><span class="op">(</span><span class="va">potato</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">potato</span><span class="op">[[</span><span class="st">'Sensory'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, commons <span class="op">=</span> <span class="fl">2</span>,
                    auto<span class="op">=</span><span class="cn">FALSE</span>, manual.par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ncomp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>,
                                                  ncommon<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Explained variance</span>
<span class="va">pot.po.man</span><span class="op">$</span><span class="va">explVar</span>
<span class="co">#&gt; $Chemical</span>
<span class="co">#&gt; C(1,2), Comp 1   D(1), Comp 1   D(1), Comp 2   D(1), Comp 3 </span>
<span class="co">#&gt;       32.22944   -72871.76265   -49467.54832        0.00000 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Compression</span>
<span class="co">#&gt; C(1,2), Comp 1 C(2,3), Comp 1 C(2,3), Comp 2 </span>
<span class="co">#&gt;      68.145954       5.504006       7.214911 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $NIRraw</span>
<span class="co">#&gt; C(2,3), Comp 1 C(2,3), Comp 2   D(3), Comp 1   D(3), Comp 2   D(3), Comp 3 </span>
<span class="co">#&gt;      32.606459       5.475702    -552.399938      15.775647       3.303994 </span>
<span class="co">#&gt;   D(3), Comp 4 </span>
<span class="co">#&gt;       0.000000</span></code></pre></div>
</div>
<div id="scores-and-loadings" class="section level2">
<h2 class="hasAnchor">
<a href="#scores-and-loadings" class="anchor"></a>Scores and loadings</h2>
<p>Scores and loadings are stored per block. Common scores/loadings are found in each of the blocks’ list of components.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Score plot for local (2,3) components</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/scoreplot.html">scoreplot</a></span><span class="op">(</span><span class="va">pot.po.man</span>, block <span class="op">=</span> <span class="fl">3</span>, labels <span class="op">=</span> <span class="st">"names"</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_E_supervised_files/figure-html/unnamed-chunk-17-1.png" width="576"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Corresponding loadings</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/scoreplot.html">loadingplot</a></span><span class="op">(</span><span class="va">pot.po.man</span>, block <span class="op">=</span> <span class="fl">3</span>, labels<span class="op">=</span><span class="st">"names"</span>, scatter <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_E_supervised_files/figure-html/unnamed-chunk-17-2.png" width="576"></p>
</div>
</div>
<div id="response-oriented-sequential-alternation---rosa" class="section level1">
<h1 class="hasAnchor">
<a href="#response-oriented-sequential-alternation---rosa" class="anchor"></a>Response Oriented Sequential Alternation - ROSA</h1>
<p>The following example uses the <em>potato</em> data to showcase some of the functions available for ROSA analyses.</p>
<div id="modelling-3" class="section level2">
<h2 class="hasAnchor">
<a href="#modelling-3" class="anchor"></a>Modelling</h2>
<p>A multi-response two-block ROSA model with up to 10 components in total is cross-validated with 10 random segments.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Model all eight potato blocks with ROSA</span>
<span class="va">ros.pot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rosa.html">rosa</a></span><span class="op">(</span><span class="va">Sensory</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">potato1</span>, ncomp <span class="op">=</span> <span class="fl">10</span>, validation <span class="op">=</span> <span class="st">"CV"</span>, segments <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ros.pot</span><span class="op">)</span>
<span class="co">#&gt; Response Orinented Sequential Alternation , fitted with the CPPLS algorithm.</span>
<span class="co">#&gt; Cross-validated using 5 random segments.</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; rosa(formula = Sensory ~ ., ncomp = 10, data = potato1, validation = "CV",     segments = 5)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ros.pot</span><span class="op">)</span>
<span class="co">#&gt; Data:    X dimension: 26 3946 </span>
<span class="co">#&gt;  Y dimension: 26 1</span>
<span class="co">#&gt; Fit method:</span>
<span class="co">#&gt; Number of components considered: 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; VALIDATION: RMSEP</span>
<span class="co">#&gt; Cross-validated using 5 random segments.</span>
<span class="co">#&gt;        (Intercept)  1 comps  2 comps  3 comps  4 comps  5 comps  6 comps</span>
<span class="co">#&gt; CV           1.778    1.066   0.9258   0.9068   0.8021   0.9775    1.097</span>
<span class="co">#&gt; adjCV        1.778    1.026   0.8888   0.8680   0.7769   0.9347    1.044</span>
<span class="co">#&gt;        7 comps  8 comps  9 comps  10 comps</span>
<span class="co">#&gt; CV       1.195    1.183    1.117     1.129</span>
<span class="co">#&gt; adjCV    1.139    1.135    1.081     1.095</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; TRAINING: % variance explained</span>
<span class="co">#&gt;          1 comps  2 comps  3 comps  4 comps  5 comps  6 comps  7 comps  8 comps</span>
<span class="co">#&gt; X          27.82    72.05    82.50    83.10    84.88    87.09    87.24    88.46</span>
<span class="co">#&gt; Sensory    76.53    83.36    84.21    87.91    88.06    88.18    88.17    88.47</span>
<span class="co">#&gt;          9 comps  10 comps</span>
<span class="co">#&gt; X          91.18     92.81</span>
<span class="co">#&gt; Sensory    88.78     88.78</span></code></pre></div>
</div>
<div id="loadings-1" class="section level2">
<h2 class="hasAnchor">
<a href="#loadings-1" class="anchor"></a>Loadings</h2>
<p>Extract loadings (not used further) and plot two first vectors of loadings.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">loads</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pls/man/scores.html">loadings</a></span><span class="op">(</span><span class="va">ros.pot</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/scoreplot.html">loadingplot</a></span><span class="op">(</span><span class="va">ros.pot</span>, comps <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_E_supervised_files/figure-html/unnamed-chunk-19-1.png" width="576"></p>
</div>
<div id="scores-1" class="section level2">
<h2 class="hasAnchor">
<a href="#scores-1" class="anchor"></a>Scores</h2>
<p>Extract scores (not used further) and plot two first vectors of scores.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sco</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pls/man/scores.html">scores</a></span><span class="op">(</span><span class="va">ros.pot</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/scoreplot.html">scoreplot</a></span><span class="op">(</span><span class="va">ros.pot</span>, comps <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, labels <span class="op">=</span> <span class="st">"names"</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_E_supervised_files/figure-html/unnamed-chunk-20-1.png" width="576"></p>
</div>
<div id="prediction-1" class="section level2">
<h2 class="hasAnchor">
<a href="#prediction-1" class="anchor"></a>Prediction</h2>
<p>A three block model is fitted using a single response, 5 components and a subset of the data. The remaining data are used as test set for prediction.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Model 20 first objects of three potato blocks</span>
<span class="va">rosT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rosa.html">rosa</a></span><span class="op">(</span><span class="va">Sensory</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">potato1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">9</span><span class="op">)</span><span class="op">]</span>, ncomp <span class="op">=</span> <span class="fl">5</span>, subset <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>
<span class="va">testset</span> <span class="op">&lt;-</span> <span class="va">potato1</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>,<span class="op">]</span>; <span class="co"># testset$Sensory &lt;- NULL</span>
<span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">rosT</span>, <span class="va">testset</span>, comps<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;      Sensory</span>
<span class="co">#&gt; 21 2.2151098</span>
<span class="co">#&gt; 22 1.5123048</span>
<span class="co">#&gt; 23 2.3008727</span>
<span class="co">#&gt; 24 1.2001610</span>
<span class="co">#&gt; 25 0.8899352</span>
<span class="co">#&gt; 26 1.2181709</span></code></pre></div>
</div>
<div id="validation-1" class="section level2">
<h2 class="hasAnchor">
<a href="#validation-1" class="anchor"></a>Validation</h2>
<p>Compute validation statistics; explained variance - R<span class="math inline">\(^2\)</span> and Root Mean Squared Error - RMSE(P/CV).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Cross-validation</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvrVal.html">R2</a></span><span class="op">(</span><span class="va">ros.pot</span><span class="op">)</span>
<span class="co">#&gt; (Intercept)      1 comps      2 comps      3 comps      4 comps      5 comps  </span>
<span class="co">#&gt;     -0.0816       0.6113       0.7066       0.7186       0.7798       0.6730  </span>
<span class="co">#&gt;     6 comps      7 comps      8 comps      9 comps     10 comps  </span>
<span class="co">#&gt;      0.5885       0.5114       0.5214       0.5728       0.5634</span>
<span class="co"># Training</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvrVal.html">R2</a></span><span class="op">(</span><span class="va">ros.pot</span>, <span class="st">'train'</span><span class="op">)</span>
<span class="co">#&gt; (Intercept)      1 comps      2 comps      3 comps      4 comps      5 comps  </span>
<span class="co">#&gt;      0.0000       0.7653       0.8336       0.8421       0.8791       0.8806  </span>
<span class="co">#&gt;     6 comps      7 comps      8 comps      9 comps     10 comps  </span>
<span class="co">#&gt;      0.8818       0.8817       0.8847       0.8878       0.8878</span>

<span class="co"># Test data</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvrVal.html">R2</a></span><span class="op">(</span><span class="va">rosT</span>, <span class="st">'test'</span>, newdata <span class="op">=</span> <span class="va">testset</span><span class="op">)</span>
<span class="co">#&gt; (Intercept)      1 comps      2 comps      3 comps      4 comps      5 comps  </span>
<span class="co">#&gt;     -0.1609       0.3158       0.3289       0.4673       0.4634       0.4574</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Cross-validation</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvrVal.html">RMSEP</a></span><span class="op">(</span><span class="va">ros.pot</span><span class="op">)</span>
<span class="co">#&gt;        (Intercept)  1 comps  2 comps  3 comps  4 comps  5 comps  6 comps</span>
<span class="co">#&gt; CV           1.778    1.066   0.9258   0.9068   0.8021   0.9775    1.097</span>
<span class="co">#&gt; adjCV        1.778    1.026   0.8888   0.8680   0.7769   0.9347    1.044</span>
<span class="co">#&gt;        7 comps  8 comps  9 comps  10 comps</span>
<span class="co">#&gt; CV       1.195    1.183    1.117     1.129</span>
<span class="co">#&gt; adjCV    1.139    1.135    1.081     1.095</span>
<span class="co"># Training</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvrVal.html">RMSEP</a></span><span class="op">(</span><span class="va">ros.pot</span>, <span class="st">'train'</span><span class="op">)</span>
<span class="co">#&gt; (Intercept)      1 comps      2 comps      3 comps      4 comps      5 comps  </span>
<span class="co">#&gt;      1.7093       0.8280       0.6972       0.6792       0.5944       0.5906  </span>
<span class="co">#&gt;     6 comps      7 comps      8 comps      9 comps     10 comps  </span>
<span class="co">#&gt;      0.5877       0.5879       0.5805       0.5726       0.5726</span>

<span class="co"># Test data</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvrVal.html">RMSEP</a></span><span class="op">(</span><span class="va">rosT</span>, newdata <span class="op">=</span> <span class="va">testset</span><span class="op">)</span>
<span class="co">#&gt; (Intercept)      1 comps      2 comps      3 comps      4 comps      5 comps  </span>
<span class="co">#&gt;       2.435        1.869        1.851        1.649        1.655        1.664</span></code></pre></div>
</div>
<div id="image-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#image-plots" class="anchor"></a>Image plots</h2>
<p>These are plots for evaluation of the block selection process in ROSA. Correlation plots show how the different candidate scores (one candidate for each block for each component) correlate to the winning block’s scores. Residual response plots show how different choices of candidate scores would affect the RMSE of the residual response. One can for instance use these plots decide on a different block selection order than the one proposed automatically by ROSA.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Correlation to winning scores</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/image.html">image</a></span><span class="op">(</span><span class="va">ros.pot</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_E_supervised_files/figure-html/unnamed-chunk-24-1.png" width="576"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Residual response given candidate scores</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/image.html">image</a></span><span class="op">(</span><span class="va">ros.pot</span>, <span class="st">"residual"</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_E_supervised_files/figure-html/unnamed-chunk-24-2.png" width="576"></p>
</div>
</div>
<div id="multiblock-redundancy-analysis---mbrda" class="section level1">
<h1 class="hasAnchor">
<a href="#multiblock-redundancy-analysis---mbrda" class="anchor"></a>Multiblock Redundancy Analysis - mbRDA</h1>
<p>The following example uses the <em>potato</em> data to showcase some of the functions available for mbRDA analyses.</p>
<div id="modelling-4" class="section level2">
<h2 class="hasAnchor">
<a href="#modelling-4" class="anchor"></a>Modelling</h2>
<p>This implementation uses a wrapper for the <em>mbpcaiv</em> function in the <em>ade4</em> package to perform mbRDA. A multi-response 5 component model is fitted.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Convert data.frame with AsIs objects to list of matrices</span>
<span class="va">potatoList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">potato</span>, <span class="va">unclass</span><span class="op">)</span>

<span class="co"># Perform mbRDA with two blocks explaining sensory attributes</span>
<span class="va">mbr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mbrda.html">mbrda</a></span><span class="op">(</span><span class="va">potatoList</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Chemical'</span>,<span class="st">'Compression'</span><span class="op">)</span><span class="op">]</span>, <span class="va">potatoList</span><span class="op">[[</span><span class="st">'Sensory'</span><span class="op">]</span><span class="op">]</span>, ncomp <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">mbr</span><span class="op">)</span>
<span class="co">#&gt; Multiblock RDA </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mbrda(X = potatoList[c("Chemical", "Compression")], Y = potatoList[["Sensory"]],     ncomp = 5)</span></code></pre></div>
</div>
<div id="loadings-and-scores" class="section level2">
<h2 class="hasAnchor">
<a href="#loadings-and-scores" class="anchor"></a>Loadings and scores</h2>
<p>The <em>mbpcaiv</em> wrapper extracts key elements for inspection using the same format as the rest of this package. The full fitted <em>mbpcaiv</em> object is also available, e.g. through <em>mbr$mbpcaivObject</em>.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Extract and view loadings</span>
<span class="va">lo_mbr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pls/man/scores.html">loadings</a></span><span class="op">(</span><span class="va">mbr</span><span class="op">)</span>
<span class="co">#&gt; Warning in loadings.multiblock(mbr): No global/consensus loadings available.</span>
<span class="co">#&gt; Returning block 1 loadings.</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">lo_mbr</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;           Comp 1      Comp 2     Comp 3     Comp 4     Comp 5</span>
<span class="co">#&gt; PEU  -0.11801083  0.45883565 -1.7606202 -0.1936109 -2.3704052</span>
<span class="co">#&gt; Sta.  1.02113965 -2.99539512  1.4968283  4.6426038 -7.6478047</span>
<span class="co">#&gt; TotN  0.50084474 -1.40837541  1.0571404  1.8302797 -1.7127587</span>
<span class="co">#&gt; Phy.  0.24298763  0.27655908  0.3695837  0.4462580 -0.7461178</span>
<span class="co">#&gt; Ca    0.02050271 -0.04647818  0.1311656  0.6243666 -0.9713523</span>
<span class="co">#&gt; Mg   -0.21159305  1.41437345 -0.6562877 -1.4166021  2.0111970</span>
<span class="co"># Plot scores</span>
<span class="fu"><a href="https://rdrr.io/pkg/pls/man/scoreplot.html">scoreplot</a></span><span class="op">(</span><span class="va">mbr</span>, labels <span class="op">=</span> <span class="st">"names"</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_E_supervised_files/figure-html/unnamed-chunk-26-1.png" width="576"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kristian Hovde Liland.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
